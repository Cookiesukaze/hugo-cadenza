document.addEventListener("DOMContentLoaded",function(){processCodeBlocks()});function processCodeBlocks(){const e=document.querySelectorAll("pre > code");e.forEach((e)=>{const r=e.parentNode;if(r.classList.contains("processed"))return;r.classList.add("processed");let m="text";e.classList.forEach(e=>{e.startsWith("language-")&&(m=e.replace("language-",""))});const o=document.createElement("div");o.className="code-block-wrapper";const i=document.createElement("div");i.className="code-block-header";const l=document.createElement("span");l.className="code-language",l.textContent=m,i.appendChild(l);const n=document.createElement("button");n.className="copy-button",n.textContent="复制",n.setAttribute("aria-label","复制代码"),n.onclick=function(){copyCodeToClipboard(e.textContent,n)},i.appendChild(n);const d=document.createElement("div");d.className="code-block-content";const a=document.createElement("div");a.className="code-with-line-numbers";const p=e.textContent,s=p.split(`
`);s[s.length-1]===""&&s.pop();const u=document.createElement("div");u.className="line-numbers";const h=document.createElement("div");h.className="code-content";const f=document.createElement("pre"),c=document.createElement("code");e.className&&(c.className=e.className),s.forEach((e,t)=>{const n=document.createElement("span");n.className="line-number",n.textContent=t+1,u.appendChild(n),t>0&&c.appendChild(document.createTextNode(`
`)),c.appendChild(document.createTextNode(e))}),f.appendChild(c),h.appendChild(f),a.appendChild(u),a.appendChild(h),d.appendChild(a),o.appendChild(i),o.appendChild(d),r.parentNode.replaceChild(o,r)})}function copyCodeToClipboard(e,t){navigator.clipboard.writeText(e).then(function(){const e=t.textContent;t.textContent="已复制!",t.classList.add("copied"),setTimeout(function(){t.textContent=e,t.classList.remove("copied")},2e3)},function(e){console.error("无法复制代码: ",e),t.textContent="复制失败",setTimeout(function(){t.textContent="复制"},2e3)})}