document.addEventListener("DOMContentLoaded",function(){processCodeBlocks()});function processCodeBlocks(){const e=document.querySelectorAll("pre > code");e.forEach((e)=>{const l=e.parentNode;if(l.classList.contains("processed"))return;l.classList.add("processed");let m="text";e.classList.forEach(e=>{e.startsWith("language-")&&(m=e.replace("language-",""))});const r=document.createElement("div");r.className="code-block-wrapper";const i=document.createElement("div");i.className="code-block-header";const a=document.createElement("div");a.className="header-left";const n=document.createElement("button");n.className="fold-button",n.setAttribute("aria-label","折叠/展开代码"),n.setAttribute("aria-expanded","true"),n.setAttribute("title","折叠/展开代码"),n.innerHTML='<span class="icon">▼</span>',n.onclick=function(){toggleCodeVisibility(this,c)},a.appendChild(n);const d=document.createElement("span");d.className="code-language",d.textContent=m,a.appendChild(d),i.appendChild(a);const s=document.createElement("button");s.className="copy-button",s.textContent="复制",s.setAttribute("aria-label","复制代码"),s.onclick=function(){copyCodeToClipboard(e.textContent,s)},i.appendChild(s);const c=document.createElement("div");c.className="code-block-content";const o=document.createElement("div");o.className="code-with-line-numbers";const u=document.createElement("div");u.className="line-numbers";const f=e.textContent.split(`
`),p=f.length;for(let e=1;e<=p;e++){const t=document.createElement("span");t.className="line-number",t.textContent=e,u.appendChild(t)}const h=document.createElement("div");h.className="code-content",h.appendChild(e.cloneNode(!0)),o.appendChild(u),o.appendChild(h),c.appendChild(o),r.appendChild(i),r.appendChild(c),l.parentNode.replaceChild(r,l)})}function toggleCodeVisibility(e,t){e.classList.toggle("folded"),e.classList.contains("folded")?(t.style.display="none",e.setAttribute("aria-expanded","false")):(t.style.display="block",e.setAttribute("aria-expanded","true"))}function copyCodeToClipboard(e,t){navigator.clipboard.writeText(e).then(function(){const e=t.textContent;t.textContent="已复制!",t.classList.add("copied"),setTimeout(function(){t.textContent=e,t.classList.remove("copied")},2e3)},function(e){console.error("无法复制代码: ",e),t.textContent="复制失败",setTimeout(function(){t.textContent="复制"},2e3)})}