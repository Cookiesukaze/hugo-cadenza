document.addEventListener("DOMContentLoaded",function(){processCodeBlocks()});function processCodeBlocks(){const e=document.querySelectorAll("pre > code");e.forEach((e)=>{const r=e.parentNode;if(r.classList.contains("processed"))return;r.classList.add("processed");let m="text";e.classList.forEach(e=>{e.startsWith("language-")&&(m=e.replace("language-",""))});const o=document.createElement("div");o.className="code-block-wrapper";const i=document.createElement("div");i.className="code-block-header";const l=document.createElement("span");l.className="code-language",l.textContent=m,i.appendChild(l);const n=document.createElement("button");n.className="copy-button",n.textContent="复制",n.setAttribute("aria-label","复制代码"),n.onclick=function(){copyCodeToClipboard(e.textContent,n)},i.appendChild(n);const d=document.createElement("div");d.className="code-block-content";const a=document.createElement("div");a.className="code-with-line-numbers";const u=document.createElement("div");u.className="line-numbers";let s=e.textContent;s.charAt(s.length-1)!==`
`&&(s+=`
`);const c=s.split(`
`);c[c.length-1]===""&&c.pop();const f=c.length;for(let e=1;e<=f;e++){const t=document.createElement("span");t.className="line-number",t.textContent=e,u.appendChild(t)}const h=document.createElement("div");h.className="code-content";const p=e.cloneNode(!0);h.appendChild(p),a.appendChild(u),a.appendChild(h),d.appendChild(a),o.appendChild(i),o.appendChild(d),r.parentNode.replaceChild(o,r)})}function copyCodeToClipboard(e,t){navigator.clipboard.writeText(e).then(function(){const e=t.textContent;t.textContent="已复制!",t.classList.add("copied"),setTimeout(function(){t.textContent=e,t.classList.remove("copied")},2e3)},function(e){console.error("无法复制代码: ",e),t.textContent="复制失败",setTimeout(function(){t.textContent="复制"},2e3)})}