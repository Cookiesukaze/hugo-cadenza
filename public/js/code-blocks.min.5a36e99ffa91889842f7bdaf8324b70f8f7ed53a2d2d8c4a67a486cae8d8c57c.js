document.addEventListener("DOMContentLoaded",function(){processCodeBlocks()});function processCodeBlocks(){const e=document.querySelectorAll("pre > code");e.forEach((e)=>{const c=e.parentNode;if(c.classList.contains("processed"))return;c.classList.add("processed");let m="text";e.classList.forEach(e=>{e.startsWith("language-")&&(m=e.replace("language-",""))});const a=document.createElement("div");a.className="code-block-wrapper";const r=document.createElement("div");r.className="code-block-header";const u=document.createElement("span");u.className="code-language",u.textContent=m,r.appendChild(u);const n=document.createElement("button");n.className="copy-button",n.textContent="复制",n.setAttribute("aria-label","复制代码"),n.onclick=function(){copyCodeToClipboard(e.textContent,n)},r.appendChild(n);const l=document.createElement("div");l.className="code-block-content";const o=document.createElement("div");o.className="code-with-line-numbers";const d=document.createElement("div");d.className="line-numbers";const p=e.textContent,s=p.split(`
`);s[s.length-1]===""&&s.pop(),s.forEach((e,t)=>{const n=document.createElement("span");n.className="line-number",n.textContent=t+1,d.appendChild(n)});const h=document.createElement("div");h.className="code-content";const f=document.createElement("pre"),i=document.createElement("code");e.className&&(i.className=e.className),s.forEach((e,t)=>{t>0&&i.appendChild(document.createTextNode(`
`));const n=applySyntaxHighlighting(e,m);i.appendChild(n)}),f.appendChild(i),h.appendChild(f),o.appendChild(d),o.appendChild(h),l.appendChild(o),a.appendChild(r),a.appendChild(l),c.parentNode.replaceChild(a,c)})}function applySyntaxHighlighting(e,t){const n=document.createDocumentFragment();switch(t){case"javascript":case"js":highlightJavaScript(e,n);break;case"python":case"py":highlightPython(e,n);break;case"html":highlightHTML(e,n);break;case"css":highlightCSS(e,n);break;case"json":highlightJSON(e,n);break;case"sql":highlightSQL(e,n);break;case"go":highlightGo(e,n);break;default:n.appendChild(document.createTextNode(e))}return n}function createSpan(e,t){const n=document.createElement("span");return n.className=t,n.textContent=e,n}function highlightJavaScript(e,t){let s=e;const n=s.match(/^(\s*)(\/\/.*$)/);if(n){n[1]&&t.appendChild(document.createTextNode(n[1])),t.appendChild(createSpan(n[2],"comment"));return}const o=["const","let","var","function","return","if","else","for","while","do","switch","case","break","continue","new","try","catch","throw","finally","class","extends","super","import","export","from","as","async","await","static","get","set","this","typeof","instanceof","in","of","null","undefined","true","false"],i=s.split(/(\s+|[.(){}[\],;:?]|=>|===|!==|==|!=|>=|<=|>|<|\+\+|--|&&|\|\||[+\-*/%=])/);i.forEach(e=>{o.includes(e)?t.appendChild(createSpan(e,"keyword")):e.match(/^(["'`]).*\1$/)?t.appendChild(createSpan(e,"string")):e.match(/^\d+(\.\d+)?$/)?t.appendChild(createSpan(e,"number")):e.match(/^[.(){}[\],;:?]|=>|===|!==|==|!=|>=|<=|>|<|\+\+|--|&&|\|\||[+\-*/%=]$/)?t.appendChild(createSpan(e,"operator")):t.appendChild(document.createTextNode(e))})}function highlightPython(e,t){let s=e;const n=s.match(/^(\s*)(#.*$)/);if(n){n[1]&&t.appendChild(document.createTextNode(n[1])),t.appendChild(createSpan(n[2],"comment"));return}const o=["def","class","return","if","elif","else","for","while","try","except","finally","with","as","import","from","pass","break","continue","in","is","not","and","or","True","False","None","lambda","nonlocal","global","assert","raise","yield","del","async","await"],i=s.split(/(\s+|[.(){}[\],;:@]|==|!=|>=|<=|>|<|[+\-*/%=])/);i.forEach(e=>{o.includes(e)?t.appendChild(createSpan(e,"keyword")):e.match(/^(["']).*\1$/)?t.appendChild(createSpan(e,"string")):e.match(/^\d+(\.\d+)?$/)?t.appendChild(createSpan(e,"number")):e.match(/^[.(){}[\],;:@]|==|!=|>=|<=|>|<|[+\-*/%=]$/)?t.appendChild(createSpan(e,"operator")):e.match(/^def\s+([a-zA-Z_]\w*)$/)?t.appendChild(createSpan(e,"function")):t.appendChild(document.createTextNode(e))})}function highlightHTML(e,t){let o=e;const s=o.match(/^(\s*)(<!--.*-->)/);if(s){s[1]&&t.appendChild(document.createTextNode(s[1])),t.appendChild(createSpan(s[2],"comment"));return}const n=o.match(/^(\s*)(<\/?[a-zA-Z0-9-]+)([^>]*)(>?)/);if(n){if(n[1]&&t.appendChild(document.createTextNode(n[1])),t.appendChild(createSpan(n[2],"tag")),n[3]){const s=n[3].matchAll(/\s+([a-zA-Z0-9-]+)(?:=(?:"([^"]*)"|'([^']*)'|([^\s>]*))?)?/g);let e=0;for(const o of s){const i=o[0],c=o[1],r=o[2]||o[3]||o[4]||"",a=o.index;if(a>e&&t.appendChild(document.createTextNode(n[3].substring(e,a))),t.appendChild(createSpan(` ${c}`,"attr-name")),r){const e=i.includes('"')?'"':i.includes("'")?"'":"";t.appendChild(document.createTextNode("=")),t.appendChild(document.createTextNode(e)),t.appendChild(createSpan(r,"attr-value")),t.appendChild(document.createTextNode(e))}e=a+i.length}e<n[3].length&&t.appendChild(document.createTextNode(n[3].substring(e)))}n[4]&&t.appendChild(createSpan(n[4],"tag"));return}t.appendChild(document.createTextNode(e))}function highlightCSS(e,t){let o=e;const i=o.match(/^(\s*)(\/\*.*\*\/)/);if(i){i[1]&&t.appendChild(document.createTextNode(i[1])),t.appendChild(createSpan(i[2],"comment"));return}const s=o.match(/^(\s*)([a-zA-Z0-9_\-.#:,\s]+)(\s*{)/);if(s){s[1]&&t.appendChild(document.createTextNode(s[1])),t.appendChild(createSpan(s[2],"selector")),t.appendChild(createSpan(s[3],"punctuation"));return}const n=o.match(/^(\s*)([a-zA-Z0-9-]+)(\s*:\s*)([^;]+)(;?)/);if(n){n[1]&&t.appendChild(document.createTextNode(n[1])),t.appendChild(createSpan(n[2],"property")),t.appendChild(document.createTextNode(n[3])),t.appendChild(createSpan(n[4],"value")),n[5]&&t.appendChild(createSpan(n[5],"punctuation"));return}const a=o.match(/^(\s*)(})/);if(a){a[1]&&t.appendChild(document.createTextNode(a[1])),t.appendChild(createSpan(a[2],"punctuation"));return}t.appendChild(document.createTextNode(e))}function highlightJSON(e,t){let n=e;const s=n.match(/^(\s*)("(?:[^"\\]|\\.)*")(\s*:)/);if(s){s[1]&&t.appendChild(document.createTextNode(s[1])),t.appendChild(createSpan(s[2],"property")),t.appendChild(createSpan(s[3],"punctuation"));return}const o=n.match(/^(\s*)("(?:[^"\\]|\\.)*")/);if(o){o[1]&&t.appendChild(document.createTextNode(o[1])),t.appendChild(createSpan(o[2],"string"));return}const i=n.match(/^(\s*)(\d+(\.\d+)?)/);if(i){i[1]&&t.appendChild(document.createTextNode(i[1])),t.appendChild(createSpan(i[2],"number"));return}const a=n.match(/^(\s*)(true|false|null)/);if(a){a[1]&&t.appendChild(document.createTextNode(a[1])),t.appendChild(createSpan(a[2],"keyword"));return}const r=n.match(/^(\s*)([{}[\],])/);if(r){r[1]&&t.appendChild(document.createTextNode(r[1])),t.appendChild(createSpan(r[2],"punctuation"));return}t.appendChild(document.createTextNode(e))}function highlightSQL(e,t){let s=e;const n=s.match(/^(\s*)(--.*$)/);if(n){n[1]&&t.appendChild(document.createTextNode(n[1])),t.appendChild(createSpan(n[2],"comment"));return}const o=["SELECT","FROM","WHERE","INSERT","UPDATE","DELETE","CREATE","ALTER","DROP","TABLE","VIEW","INDEX","JOIN","LEFT","RIGHT","INNER","OUTER","FULL","ON","AS","ORDER","BY","GROUP","HAVING","LIMIT","OFFSET","UNION","ALL","DISTINCT","INTO","VALUES","SET","CONSTRAINT","PRIMARY","FOREIGN","KEY","NOT","NULL","DEFAULT","AUTO_INCREMENT","REFERENCES","CASCADE","RESTRICT","CHECK","UNIQUE","PROCEDURE","FUNCTION","TRIGGER","BEGIN","END","DECLARE","CASE","WHEN","THEN","ELSE","ELSEIF","WHILE","LOOP","LEAVE","ITERATE","RETURN","CALL","IF","EXISTS","AND","OR","IN","BETWEEN","LIKE","IS","TRUE","FALSE"],i=s.split(/(\s+|[.(){}[\],;]|>=|<=|<>|=|>|<)/);i.forEach(e=>{const n=e.toUpperCase();o.includes(n)?t.appendChild(createSpan(e,"keyword")):e.match(/^(['"]).*\1$/)?t.appendChild(createSpan(e,"string")):e.match(/^\d+(\.\d+)?$/)?t.appendChild(createSpan(e,"number")):e.match(/^[.(){}[\],;]|>=|<=|<>|=|>|<$/)?t.appendChild(createSpan(e,"operator")):t.appendChild(document.createTextNode(e))})}function highlightGo(e,t){let s=e;const n=s.match(/^(\s*)(\/\/.*$)/);if(n){n[1]&&t.appendChild(document.createTextNode(n[1])),t.appendChild(createSpan(n[2],"comment"));return}const o=["package","import","func","return","var","const","type","struct","interface","map","chan","go","defer","if","else","switch","case","default","for","range","break","continue","select","goto","fallthrough","make","new","append","len","cap","copy","close","delete","complex","real","imag","panic","recover","print","println","true","false","nil","iota"],i=s.split(/(\s+|[.(){}[\],;:]|:=|==|!=|>=|<=|>|<|\+\+|--|&&|\|\||[+\-*/%=])/);i.forEach(e=>{o.includes(e)?t.appendChild(createSpan(e,"keyword")):e.match(/^(["'`]).*\1$/)?t.appendChild(createSpan(e,"string")):e.match(/^\d+(\.\d+)?$/)?t.appendChild(createSpan(e,"number")):e.match(/^[.(){}[\],;:]|:=|==|!=|>=|<=|>|<|\+\+|--|&&|\|\||[+\-*/%=]$/)?t.appendChild(createSpan(e,"operator")):e.match(/^func\s+([a-zA-Z_]\w*)$/)?t.appendChild(createSpan(e,"function")):t.appendChild(document.createTextNode(e))})}function copyCodeToClipboard(e,t){navigator.clipboard.writeText(e).then(function(){const e=t.textContent;t.textContent="已复制!",t.classList.add("copied"),setTimeout(function(){t.textContent=e,t.classList.remove("copied")},2e3)},function(e){console.error("无法复制代码: ",e),t.textContent="复制失败",setTimeout(function(){t.textContent="复制"},2e3)})}