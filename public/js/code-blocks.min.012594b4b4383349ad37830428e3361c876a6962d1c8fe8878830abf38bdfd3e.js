document.addEventListener("DOMContentLoaded",function(){processCodeBlocks()});function processCodeBlocks(){const e=document.querySelectorAll("pre > code");e.forEach((e)=>{const s=e.parentNode;if(s.classList.contains("processed"))return;s.classList.add("processed");let u="text";e.classList.forEach(e=>{e.startsWith("language-")&&(u=e.replace("language-",""))});const o=document.createElement("div");o.className="code-block-wrapper";const i=document.createElement("div");i.className="code-block-header";const r=document.createElement("span");r.className="code-language",r.textContent=u,i.appendChild(r);const n=document.createElement("button");n.className="copy-button",n.textContent="复制",n.setAttribute("aria-label","复制代码"),n.onclick=function(){copyCodeToClipboard(e.textContent,n)},i.appendChild(n);const c=document.createElement("div");c.className="code-block-content";const a=document.createElement("div");a.className="code-with-line-numbers";const l=document.createElement("div");l.className="line-numbers";const h=e.textContent.split(`
`),m=h.length;for(let e=1;e<=m;e++){const t=document.createElement("span");t.className="line-number",t.textContent=e,l.appendChild(t)}const d=document.createElement("div");d.className="code-content",d.appendChild(e.cloneNode(!0)),a.appendChild(l),a.appendChild(d),c.appendChild(a),o.appendChild(i),o.appendChild(c),s.parentNode.replaceChild(o,s)})}function copyCodeToClipboard(e,t){navigator.clipboard.writeText(e).then(function(){const e=t.textContent;t.textContent="已复制!",t.classList.add("copied"),setTimeout(function(){t.textContent=e,t.classList.remove("copied")},2e3)},function(e){console.error("无法复制代码: ",e),t.textContent="复制失败",setTimeout(function(){t.textContent="复制"},2e3)})}